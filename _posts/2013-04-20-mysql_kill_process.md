---
layout: post
category : MySQL
title: MySQLで実行中のクエリ一覧を見て、SQLを強制終了する方法
tagline: 
author : sakuraba
tags : [MySQL]
---
{% include JB/setup %}

時々、アプリケーションが暴走して変なクエリが発行されたり、いつまでたってもクエリが終わらない時とかありますよね。そんな時には、MySQLで実行中のSQLを見て、問題ありそうなものを強制終了させちゃいます。

## MySQLにログイン

	$ mysql -u hoge -phoge db

まずはMySQLにログイン。その後、

```sql
> show processlist;
```

と打つと現在実行しているSQLの一覧が表示されます。項目の中にTimeというのがありますが、これが実行から何秒経過しているかを表しています。

ちなみに

```sql
> show full processlist \G;
```

と full を付け加えるとSQLの全文が表示される + \G を末尾に付け加えるとクエリ毎に分割されて見やすくなります。

明らかに時間がかかって負荷の原因になっているものがあれば Id という項目で表示されている数値を使って強制終了します。(*) やみくもに強制終了すればいいというわけではないので適宜使ってください。

```sql
> kill プロセスID
```

これだけです。

まぁ、そもそもの負荷の原因を探って修正しないと意味ないですが、突発的な対処として。